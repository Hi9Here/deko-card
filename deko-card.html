<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../please-js/please-js.html">

<!--
  `deko-card`
  @demo demo/index.html
-->

<dom-module id="deko-card">
  <template>
    <style>
      /* .71 *280  */
      :host {min-height:280px;min-width:198px;display:inline-block;position:relative;
        margin-bottom: -127%; /* stacked */
        transition: margin-bottom 1s;
        z-index:2;
      }
      :host:focus {
        margin-bottom: 0;
        z-index:3;
      }
      :host:before {
         display: block;
         content: " ";
         width: 100%;
         padding-top: 140%;
      }
      :host > paper-material {
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: 5px;
        background-color: #fafafa;
        color: #212121;
        border-radius: 7px;
        position: absolute;
        overflow: hidden;
      }
      .open {
        overflow-y: scroll;
        border-radius: 17px;
      }
    </style>
    <paper-material elevation="2" class$="[[display]]" style$="background:[[_bg]];color:[[_fg]]">
      <slot></slot><content></content>
    </paper-material>
  </template>
</dom-module>
<script>
  Polymer({
    is: "deko-card",
    properties: {
      icon: String,
      toolbarColor: String,
      _bg: {
        type: String,
        computed: "getBg(card.toolbarColor, card.title)",
      },
      _fg: {
        type: String,
        computed: "getFg(_bg)",
      },
    },
    getBg: function(color, title) {
      return color || Please.make_color({
        from_hash: title
      })
    },
    getFg: function(bg) {
      if (bg.length === 4) {
        bg = "#" + bg.charAt(1) + bg.charAt(1) + bg.charAt(2) + bg.charAt(2) + bg.charAt(3) + bg.charAt(3)
      }
      var c = bg.substring(1); // strip #
      var rgb = parseInt(c, 16); // convert rrggbb to decimal
      var r = (rgb >> 16) & 0xff; // extract red
      var g = (rgb >> 8) & 0xff; // extract green
      var b = (rgb >> 0) & 0xff; // extract blue
      var luma = 0.2126 * r + 0.7152 * g + 0.0722 * b; // per ITU-R BT.709
      if (luma > 128) {
        return "#000"
      } else {
        return "#FFF"
      }
    },
  })
</script>
